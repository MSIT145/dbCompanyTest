@model dbCompanyTest.Models.TestStaff
@{
    ViewData["Title"] = "Index";
}
@{
    Layout = "_Back_Layout";
}

<h1>員工頁面</h1>

<h4>TestStaff</h4>
<h2 id="stf_info">@ViewBag.acc</h2>

<div >
    <table>
        <caption>待出貨清單</caption>
        <thead>
            <tr>
                <th>訂單編號</th>
                <th>客戶編號</th>
                <th>訂單狀態</th>
                <th>商品名稱</th>
                <th>尺寸種類</th>
                <th>商品數量</th>
                <th>送貨地址</th>
            </tr>
        </thead>
        <tbody id="Sheeplist_tbody">

        </tbody>
    </table>
</div>
<div >
    <table>
        <caption>待辦事項</caption>
        <thead>
            <tr>
                <th>交辦內容</th>
                <th>批示</th>
                <th>狀態</th>                
            </tr>
        </thead>
        <tbody id="ToDolist_tbody">

        </tbody>
    </table>
</div>


@section Scripts {

    <script>
        var split = $(`#stf_info`).text().indexOf(' ');
        var stf = $(`#stf_info`).text().substr(0, split)
        LoadSheeplist();
        LoadToDoList();

        function LoadSheeplist() {
            $.ajax({
                url: `@Url.Content("~/Staff_Home/LoadSheeplist")`,
                type: "GET",
                dataType: "json"
            })
                .done(data => {
                    let docFrag = $(document.createDocumentFragment());
                    $.each(data, function (i, i_val) {
                        const eleT = $(`<tr></tr>`).append(`<td>${i_val.訂單編號}</td>
                        <td>${i_val.客戶編號}</td>
                        <td>${i_val.訂單狀態}</td>
                        <td>${i_val.商品名稱}</td>
                        <td>${i_val.尺寸種類}</td>
                        <td>${i_val.商品數量}</td>
                        <td>${i_val.送貨地址}</td>`);
                        docFrag.append(eleT);
                    });
                    $("#Sheeplist_tbody").html(docFrag);

                })
        }

        function LoadToDoList() {
            $.ajax({
                url: `@Url.Content("~/Staff_Home/LoadToDoList")`,
                type: "GET",
                data: { "stf": stf },
                dataType: "json"
            })
                .done(data => {
                    let docFrag = $(document.createDocumentFragment());
                    $.each(data, function (i, i_val) {
                        const eleT = $(`<tr></tr>`).append(`<td>${i_val.交辦內容}</td>
                                        <td>${i_val.批示}</td>
                                        <td>${i_val.狀態}</td>`);
                        docFrag.append(eleT);
                    });
                    $("#ToDolist_tbody").html(docFrag);

                })
        }

    </script>

    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

}


@model dbCompanyTest.Models.ToDoList

@{
    ViewData["Title"] = "Create";
}
@{
    Layout = "_Back_Layout_Sneat";
}

<h1>建立表單</h1>

<h4 id="stf_info">@ViewBag.acc</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Create">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="表單類型" class="control-label"></label>
                <select asp-for="表單類型" class="form-control">
                    <option>常規表單</option>
                    <option>人事表單</option>
                </select>
                <span asp-validation-for="表單類型" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="員工編號" class="control-label"></label>
                <input asp-for="員工編號" class="form-control" value="@ViewBag.acc" type="hidden"/>
            </div>
            <div class="form-group" id="div_cont">
                <label asp-for="表單內容" class="control-label"></label>
                <input asp-for="表單內容" class="form-control" />
                <span asp-validation-for="表單內容" class="text-danger"></span>
            </div>
            <div class="form-group"id="div_ans">
                <label asp-for="回覆" class="control-label"></label>
                <input asp-for="回覆" class="form-control" />
                <span asp-validation-for="回覆" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_sta">
                <label asp-for="表單狀態" class="control-label"></label>
                <input asp-for="表單狀態" class="form-control" id="inp_sta" />
                <span asp-validation-for="表單狀態" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_starttime">
                <label asp-for="起單時間" class="control-label"></label>
                <input asp-for="起單時間" class="form-control" id="inp_starttime"/>
                <span asp-validation-for="起單時間" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_whostart">
                <label asp-for="起單人" class="control-label"></label>
                <input asp-for="起單人" class="form-control" id="inp_whostart" />
                <span asp-validation-for="起單人" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_super_vs">
                <label asp-for="部門主管" class="control-label"></label>
                <input asp-for="部門主管" class="form-control" id="inp_super_vs" />
                <span asp-validation-for="部門主管" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_super_vs_sin">
                <label asp-for="部門主管簽核" class="control-label"></label>
                <input asp-for="部門主管簽核" class="form-control" />
                <span asp-validation-for="部門主管簽核" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_super_vs_opn">
                <label asp-for="部門主管簽核意見" class="control-label"></label>
                <input asp-for="部門主管簽核意見" class="form-control" />
                <span asp-validation-for="部門主管簽核意見" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_super_vs_time">
                <label asp-for="部門主管簽核時間" class="control-label"></label>
                <input asp-for="部門主管簽核時間" class="form-control" />
                <span asp-validation-for="部門主管簽核時間" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_co_dep">
                <label asp-for="協辦部門" class="control-label"></label>
                <input asp-for="協辦部門" class="form-control" />
                <span asp-validation-for="協辦部門" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_co_dep_sin">
                <label asp-for="協辦部門簽核" class="control-label"></label>
                <input asp-for="協辦部門簽核" class="form-control" />
                <span asp-validation-for="協辦部門簽核" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_co_dep_who">
                <label asp-for="協辦部門簽核人員" class="control-label"></label>
                <input asp-for="協辦部門簽核人員" class="form-control" />
                <span asp-validation-for="協辦部門簽核人員" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_co_dep_opn">
                <label asp-for="協辦部門簽核意見" class="control-label"></label>
                <input asp-for="協辦部門簽核意見" class="form-control" />
                <span asp-validation-for="協辦部門簽核意見" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_co_dep_time">
                <label asp-for="協辦部門簽核時間" class="control-label"></label>
                <input asp-for="協辦部門簽核時間" class="form-control" />
                <span asp-validation-for="協辦部門簽核時間" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_boss_sin">
                <label asp-for="老闆簽核" class="control-label"></label>
                <input asp-for="老闆簽核" class="form-control" />
                <span asp-validation-for="老闆簽核" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_boss_opn">
                <label asp-for="老闆簽核意見" class="control-label"></label>
                <input asp-for="老闆簽核意見" class="form-control" />
                <span asp-validation-for="老闆簽核意見" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_boss_time">
                <label asp-for="老闆簽核時間" class="control-label"></label>
                <input asp-for="老闆簽核時間" class="form-control" />
                <span asp-validation-for="老闆簽核時間" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_executor">
                <label asp-for="執行人" class="control-label"></label>
                <select asp-for="執行人" class="form-control" id="sele_executor"></select>
                <span asp-validation-for="執行人" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_execut_time">
                <label asp-for="執行時間" class="control-label"></label>
                <input asp-for="執行時間" class="form-control" />
                <span asp-validation-for="執行時間" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_executor_sin">
                <label asp-for="執行人簽核" class="control-label"></label>
                <input asp-for="執行人簽核" class="form-control" id="inp_executor_sin"/>
                <span asp-validation-for="執行人簽核" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_Attached">
                <label asp-for="附件" class="control-label"></label>
                <input asp-for="附件" class="form-control" />
                <span asp-validation-for="附件" class="text-danger"></span>
            </div>
            <div class="form-group" id="div_Attached_path">
                <label asp-for="附件path" class="control-label"></label>
                <input asp-for="附件path" class="form-control" />
                <span asp-validation-for="附件path" class="text-danger"></span>
            </div>
            <div class="form-group">
                
                <input type="submit" value="Create" class="btn btn-primary" id="inp_start" />
            </div>
        </form>
    </div>
</div>

<div>
    <a asp-action="Index">Back to List</a>
</div>

@section Scripts {
    <script>
        var split = $(`#stf_info`).text().indexOf(' ');
        var stf = $(`#stf_info`).text().substr(0, split);
        $("#stfId").val(stf);
        ragular();

        $.ajax({
            url: `@Url.Content("~/Staff_Home/stf_info")`,
            type: "POST",
            data: { "stf": stf },
            dataType: "json"
        })
            .done(data => {
                console.log(data);
                let whostart = `${data.部門} ${data.員工編號} ${data.員工姓名}`;
                $("#inp_whostart").val(whostart);
                $("#inp_super_vs").val(`${data.部門} ${data.主管}`);
                console.log($("#inp_whostart").val());
                console.log($("#inp_super_vs").val());
            })

        $.ajax({
            url: `@Url.Content("~/Staff_Home/all_stf_info")`,
            type: "POST",
            dataType: "json"
        })
            .done(data => {
                let docFrag = $(document.createDocumentFragment());
                $.each(data, function (i, i_val) {
                    const sele = $(`<option></option>`).append(`${i_val.部門} ${i_val.員工編號} ${i_val.員工姓名}`);
                    docFrag.append(sele);
                });
                $("#sele_executor").html(docFrag);
            })



                

        $("#list_type").on('change', function () {
            if ($("#list_type").val() == "常規表單") {
                $("div").css("display", "")
                ragular();



            }
            else if ($("#list_type").val() == "人事表單") {
                $("div").css("display", "")
                ragular();
                $("#div_executor").css("display", 'none');
            }
        })

        $("#inp_start").on('click', function () {
            let dt = new Date();
            $("#inp_starttime").val(dt)
            $("#inp_executor_sin").val(`待簽`)
            $("#inp_sta").val(`執行 待簽`)
        })



        function ragular() {
            $("#div_ans").css("display", 'none');
            $("#div_sta").css("display", 'none');
            $("#div_starttime").css("display", 'none');
            $("#div_super_vs").css("display", 'none');
            $("#div_super_vs_sin").css("display", 'none');
            $("#div_super_vs_opn").css("display", 'none');
            $("#div_super_vs_time").css("display", 'none');
            $("#div_co_dep").css("display", 'none');
            $("#div_co_dep_sin").css("display", 'none');
            $("#div_co_dep_who").css("display", 'none');
            $("#div_co_dep_opn").css("display", 'none');
            $("#div_co_dep_time").css("display", 'none');
            $("#div_boss_time").css("display", 'none');
            $("#div_boss_sin").css("display", 'none');
            $("#div_boss_opn").css("display", 'none');
            $("#div_execut_time").css("display", 'none');
            $("#div_executor_sin").css("display", 'none');
        }

    </script>



    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
